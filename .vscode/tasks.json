// This file is automatically generated by Teams Toolkit.
// The teamsfx tasks defined in this file require Teams Toolkit version >= 4.1.0.
// See https://aka.ms/teamsfx-debug-tasks for details on how to customize each task and how to integrate with existing Teams Toolkit projects.
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Start Teams App Locally",
      "dependsOn": [
        "Validate & install prerequisites",
        "Start local tunnel",
        "Provision",
        "Deploy",
        "Start services"
      ],
      "dependsOrder": "sequence"
    },
    {
      "label": "Validate & install prerequisites",
      "type": "teamsfx",
      "command": "debug-check-prerequisites",
      "args": {
        "prerequisites": ["nodejs", "m365Account", "portOccupancy"],
        "portOccupancy": [3978, 9239]
      }
    },
    {
      "label": "Start local tunnel",
      "type": "teamsfx",
      "command": "debug-start-local-tunnel",
      "args": {
        "type": "dev-tunnel",
        "ports": [
          {
            "portNumber": 3978,
            "protocol": "http",
            "access": "public",
            "writeToEnvironmentFile": {
              "endpoint": "PROVISIONOUTPUT__AZUREWEBAPPBOTOUTPUT__SITEENDPOINT",
              "domain": "PROVISIONOUTPUT__AZUREWEBAPPBOTOUTPUT__DOMAIN"
            }
          }
        ],
        "env": "local"
      },
      "isBackground": true,
      "problemMatcher": "$teamsfx-local-tunnel-watch"
    },
    {
      "label": "Provision",
      "type": "teamsfx",
      "command": "provision",
      "args": {
        "env": "local"
      }
    },
    {
      "label": "Deploy",
      "type": "teamsfx",
      "command": "deploy",
      "args": {
        "env": "local"
      }
    },
    {
      "label": "Start services",
      "dependsOn": ["Start bot"]
    },
    {
      "label": "Start bot",
      "type": "shell",
      "command": "npm run dev:teamsfx",
      "isBackground": true,
      "options": {
        "cwd": "${workspaceFolder}/bot"
      },
      "problemMatcher": {
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "[nodemon] starting",
          "endsPattern": "restify listening to|Bot/ME service listening at|[nodemon] app crashed"
        }
      }
    },
    {
      "type": "teamsfx",
      "command": "bot start",
      "problemMatcher": ["$teamsfx-bot-watch"],
      "label": "teamsfx: bot start"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev",
      "path": "bot",
      "group": "rebuild",
      "problemMatcher": [],
      "label": "npm: dev - bot",
      "detail": "nodemon --inspect=9239 --signal SIGINT ./index.js"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    },
    {
      "type": "npm",
      "script": "dev:teamsfx",
      "path": "bot",
      "problemMatcher": [],
      "label": "npm: dev:teamsfx - bot",
      "detail": "env-cmd --silent -f .env.teamsfx.local npm run dev"
    }
  ]
}
